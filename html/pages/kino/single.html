{{define "kino-single"}}

{{template "head" .Head}}
{{template "top" .}}

    <div id="part">
    {{template "kino-single-part" .}}
    </div>

    {{template "bot" .Head}}

{{end}}}

{{define "kino-single-part"}}

    {{template "subnav" (snav .Entry.Parent .Entry.Id .Head.Lang)}}

    {{$eL := eL .Entry .Head.Lang}}
    <div id="body">
      <h1 class="video-title-bar">
        <span class="video-date">
          {{.Entry.Date.Format "2"}}
          {{abbr (monthLang .Entry.Date $.Head.Lang)}}
        </span>
        <span class="video-title">
        {{.Entry.Info.Field "title-display" .Head.Lang}}
        </span>
      </h1>
          {{template "kino-entry" $eL}}
    </div>

    <div class="video-grid">
    {{range .Neighbors}}
    {{template "kino-card" eL . $.Head.Lang}}
    {{end}}
    </div>

  {{if isLocal}}
  <div class="margin">
  {{template "edit-link" $eL}}
  </div>
  {{end}}

{{end}}

{{define "kino-date" -}}
{{.E.Date.Format "2"}} {{abbr (monthLang .Entry.Date .L)}}
{{- end}}

{{define "kino-entry"}}
{{$type := $.E.Type}}
    {{if eq $type "set"}}
      {{template "kino-set" .}}
    {{else if or (eq $type "video") (eq $type "audio")}}
      {{template "kino-av" .}}
    {{else}}
      {{template "entry" .}}
    {{end}}
{{end}}

{{define "kino-set"}}
<div class="set">
    {{range .E.Entries}}
      {{template "kino-entry" (eL . $.L)}}
    {{end}}
</div>
{{end}}

{{define "kino-av"}}
{{if eq .E.Type "audio"}}
  <div class="column kino-audio">
    {{template "entry" .}}
  </div>
{{else}}
  {{template "entry" .}}
{{end}}

  {{template "kino-transcript" .}}

{{end}}

{{define "kino-transcript"}}
  {{with .E.Transcript}}
    {{$text := index .Langs $.L}}
    {{if $text}}
    <div class="transcript transcript-kino column">
      <h3>{{var "transcript" $.L}}</h3>
      <div class="{{$.E.Info.TextStyle}}">
        {{$text}}
      </div>
      {{template "footnotes" (nL .Footnotes $.L)}}
    </div>
    {{end}}
  {{end}}
{{end}}
