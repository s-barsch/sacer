{{define "graph-year"}}
{{template "head" .Head}}
{{template "top" .}}
{{template "subnav" (snav .Tree 0 .Head.Lang)}}

<div class="section-title__box section-title--year">
    <h1 class="section-title">
        {{.Tree.Date.Format "2006"}}
    </h1>
</div>
{{template "media-groups" (eLy .Tree false $.Head.Lang)}}
{{template "bot" .Head}}
{{end}}


{{define "media-groups"}}
    <div class="media-groups">
    {{range $i, $group := .$E.Entries.Groups}}
        <section class="{{if $group.First.IsBlob}}blob{{else}}text{{end}}-group">
            {{range $group}}
                {{template "entry-graph" (eLy . $.L false}}
            {{end}}
        </section>
    {{end}}
    </div>
{{end}}

{{/*
{{define "graph-main"}}
{{template "head" .Head}}
{{template "top" .}}
{{template "subnav" (snav .Tree 0 .Head.Lang)}}


    {{$isMain := lt .Hold.Level 1}}


    <div class="section-title__box section-title--graph">
        {{if $isMain}}
        <h1 class="section-title">
            {{.Head.Title}}
        </h1>
        <h4 class="section-lead">
            {{var "graph-subtitle" .Head.Lang}}
        </h4>

        {{else}}
        <h1 class="section-title">
            {{.Hold.Date.Format "2006"}}
        </h1>
        {{end}}
    </div>


    <section class="graph-grid margin">

        {{$depth := .Hold.Level}}

        {{if eq $depth 0}}
            <!-- MAIN -->
            {{$lang := .Head.Lang}}
            {{$months := (.Els.Offset 0 10).Months}} <!-- 25 -->
            {{range $i, $els := $months}}
            {{if $i}}
            <h2 class="month-title">
                {{monthLang (index $els 0).Date $lang}}
            </h2>
            {{end}}
                {{template "media-groups" (elsArg $els false $lang)}}
            {{end}}

            <div class="graph-tip">
                {{var "graph-main-more" .Head.Lang}}
            </div>

            {{ template "graph-main-more" .}}
        {{else if lt .Hold.Level 2}}
            <!-- YEAR -->
            {{$lang := .Head.Lang}}
            {{$months := .Els.Months}}
            {{range $i, $els := $months}}
            {{$firstEntry := (index $els 0)}}
            {{$monthNum := $firstEntry.Date.Format "01"}}
                <section id="{{$monthNum}}" class="month">
                    <h2 class="month-title">
                        <a href="#{{$monthNum}}t d">{{monthLang $firstEntry.Date $lang}}</a>
                    </h2>

                    {{if (gt $i 2)}}
                        {{template "media-groups" (elsArg $els true $lang)}}
                    {{else}}
                        {{template "media-groups" (elsArg $els false $lang)}}
                    {{end}}
                </section>
            {{end}}

            {{template "prev-next-year" .}}
        {{end}}

    </section>

    {{template "subnav-fixed" (snav .Tree 0 .Head.Lang)}}

    <div id="top-link" class="hide">
            <!--
            <img src="/static/img/uarr.svg" alt="â†‘"
            -->
        <a class="topl-corner uarr" href="#top">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.76 17.96" height="67.88" width="55.786"><path d="M7.38 0L0 10.087v.001h3.834v7.872h7.092v-7.872h3.833z" fill="#002f74"/></svg>
        </a>
    </div>

    <script>
    {{if eq $depth 0}}
      var pageVars = { type: "graph-main" }
    {{else}}
      var pageVars = { type: "graph-year" }
    {{end}}
    </script>

    {{template "bot" .Head}}

{{end}}


{{/*
{{define "prev-next-year"}}
    {{$lang := .Head.Lang}}
    <div class="prev-next-year graph-tip">
        {{with .Next}}
            &larr; <a href="{{.Permalink $lang}}">{{.Title $lang}}</a>
        {{else}}
            &nbsp;
        {{end}}
        {{with .Prev}}
            <span class="right">
            <a href="{{.Permalink $lang}}">{{.Title $lang}}</a>
            &rarr; 
            </span>
        {{end}}
    </div>
{{end}}

{{define "graph-full-tip"}}
<div class="more-tip">
 (var "graph-full" .Lang)
</div>
{{end}}

{{define "graph-els"}}
{{$lang := .Lang}}
{{with .El}}
  {{range .Days}}
    {{range .}}
      {{template "graph-main-el" (elArg . $lang)}}
    {{end}}
  {{end}}
{{end}}
{{end}}

{{define "media-groups"}}
    {{$lang := .Lang}}
    {{$lazy := .Lazy}}
    <div class="media-groups">
    {{range $i, $group := .Els.MediaGroups}}
      {{$firstType := (elType (index $group 0))}}
      {{if eq $firstType "image"}}
      <section class="images">
      {{else if eq $firstType "set"}}
      <section class="text">
      {{else if eq $firstType "text"}}
      <section class="texts">
      {{else if eq $firstType "html"}}
      <section class="texts">
      {{else}}
      <section class="texts">
      {{end}}

        {{range $group}}
            {{template "graph-main-el" (elArg . $lazy $lang)}}
        {{end}}
        <!--
        <div class="phantom"></div>
        -->

      </section>
    {{end}}
    </div>
{{end}}

{{define "graph-month"}}
    <section id="{{.Hold.Date.Format "01"}}" class="month">

        <h2 class="subh month-title">
            <a href="{{.Hold.Permalink .Lang}}">{{.Hold.Info.Title .Lang}}</a>
        </h2>

        {{template "media-groups" (elsArg .Hold.Els .Lazy .Lang)}}
    </section>
{{end}}



{{define "private-mark-graph"}}
    {{if eq (index .Info "private") "true"}}<div class="private-graph"></div>{{end}}
{{end}}

{{define "graph-date"}}
{{if ne "true" (index .El.Info "nodate")}}
<header class="graph-date">
            {{template "private-mark-graph" .El}}
    <a class="" href="{{.El.Permalink .Lang}}">
        {{.El.Date.Format "2<span class=\"ddot\">.</span> 1<span class=\"ddot\">.</span>"}}
    </a>
</header>
{{end}}
{{end}}


{{define "graph-image-thumbnail"}}

  {{$lang := .Lang}}
  {{$lazy := .Lazy}}


    {{$alt := .El.Title $lang}}
    {{$src := ""}}
    {{$realSrc := .El.ImagePath 320 $lang}}
    {{$sizes := "(max-width: 450px) 177px, (max-width: 1024px) 222px, 320px"}}

    {{if .Lazy}}
      {{$src = .El.PlaceholderPath}}
    {{else}}
      {{$src = $realSrc}}
    {{end}}

    <img class="thumbi{{if .Lazy}} lazy{{end}}" src="{{$src}}" alt="{{$alt}}"  /*}}{{/*sizes="{{$sizes}}"*/}}{{/*
         {{if .Lazy}}
             data-src="{{$realSrc}}"
             data-srcset="{{- template "graph-thumb-srcset" (elArg .El .Lazy .Lang)}}"
         {{else}}
             srcset="{{template "graph-thumb-srcset" (elArg .El .Lazy .Lang)}}"
         {{end}}
    >


{{end}}

{{define "graph-thumb-srcset" -}}
{{.El.SrcSet 320 .Lang}}, {{.El.SrcSet 480 .Lang}}, {{.El.SrcSet 960 .Lang}}, {{.El.SrcSet 1280 .Lang}}{{- end}}

{{define "graph-main-set"}}

{{if .El.Cover}}
    <a class="thumbl" href="{{.El.Permalink .Lang}}">
    {{template "graph-image-thumbnail" (elArg .El.Cover .Lazy .Lang)}}
    </a>
{{else}}
<!--
    <li><a href="{{.El.Permalink .Lang}}">{{.El.Info.Title .Lang}}</a></li>
-->
{{template "set-graph" .}}
{{end}}

{{end}}

{{define "set-graph"}}
{{$lang := .Lang}}
<article class="graph-set">
<div>
    {{range $i, $e := .El.Els}}
        {{if eq "image" (elType $e)}}
        <section class="images">
            <span class="thumb">
                <a class="thumbl" href="{{$e.File.Hold.Permalink $lang}}">
                    {{template "graph-image-thumbnail" (elArg $e false $lang)}}
                </a>
            </span>
        </section>
        {{else if eq "video" (elType $e)}}
            <div class="video-main">
                {{template "el" (elArg $e false $lang)}}
                {{template "private-mark-graph" $e}}
            </div>
        {{else}}
            <div class="text-entry">
                <div>
                    {{template "el" (elArg $e false $lang)}}
                    {{template "private-mark-graph" $e}}
                </div>
            </div>
        {{end}}
    {{end}}
</div>
{{template "graph-date" (elArg .El false $lang)}}
</article>
{{end}}

{{define "set-graph-el"}}
{{$lang := .Lang}}
<div class="el-text margin">
{{range $i, $e := .El.Els}}
    {{$type := elType $e}}
    {{if eq $type "text"}}
        <article class="text-entry graph-text">
            <div>
                {{template "el" (elArg $e false $lang)}}
            </div>
        </article>
    {{else}}
        <article>
                {{template "el" (elArg $e false $lang)}}
        </article>
    {{end}}
{{end}}
</div>
{{end}}


*/}}
