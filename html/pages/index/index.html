{{define "index-main"}}
{{template "head" .Head}}
{{template "top" .}}

{{template "subnav" (snav .Tree 0 .Head.Lang)}}

    <div class="section-title__box section-title--index">
        <h1 class="section-title">
            {{.Tree.Title .Head.Lang}}
        </h1>
        <h4 class="section-lead">
            {{var "index-subtitle" .Head.Lang}}
        </h4>
    </div>

    {{template "index-entries" (eL .Tree .Head.Lang)}}

    <section class="index-map">
        <h2 id="map" class="subh subtitle">
          <a href="#map">{{var "map" .Head.Lang}}</a>
        </h2>

        <div class="center">
        {{var "indexmap" .Head.Lang}}
        </div>
        <div style="text-align:right;">
            <small>{{var "map-info" .Head.Lang}}</small>
        </div>
    </section>

    <section id="serial">
        <h2 class="subh subtitle">
          <a href="/index/serial/">Serial</a>
        </h2>

        {{range .Recents.Offset 0 35}}
          {{template "front-index-entry" (eL . $.Head.Lang)}}
        {{end}}

        <div class="more-tip">
            {{var "serial-link" .Head.Lang}}
        </div>
    </section>

    {{template "bot" .Head}}
{{end}}


{{define "index-page"}}
{{template "head" .Head}}
{{template "top" .}}

{{/* TODO: isArticle */}}

{{template "subnav" (snav .Tree 0 .Head.Lang)}}

<h1 class="hold-title l{{.Tree.Level}}">
        {{if eq .Tree.Level 1}}
        <span class="fleuron">❧</span>
        {{end}}
        {{.Tree.Title .Head.Lang}}
            {{/*.Hold.Info.Field "title-hyph" .Head.Lang*/}}
        </h1>

        {{template "index-entries" (eL .Tree .Head.Lang)}}

{{template "bot" .Head}}
{{end}}



{{define "index-entries"}}
    {{range .E.Entries}}
      <article id="{{normalize (.Title $.Lang)}}" class="entry--index">
          {{template "index-entry" (eL . $.Lang)}}
      </article>
    {{end}}
    {{if eq 0 (len .E.Entries)}}
        <article class="entry--index">
          –
        </article>
    {{end}}
{{end}}

{{define "index-entry"}}
  <div class="index-date-top">
    {{template "index-date" .}}
  </div>

  {{if .E.IsBlob}}
    {{template "entry" .}}
  {{else}}
    <article class="tob tob--index">
        {{template "entry" .}}
    </article>
  {{end}}

  <div class="index-date-bot">
    {{template "index-date" .}}
  </div>
  {{template "edit-link" .}}

{{end}}

{{define "index-date-link"}}
    {{$year := .E.Date.Format "06"}}
    <a class="index-datel" href="{{.E.Perma .Lang}}">
        {{.E.Date.Format "2. 1."}}
        {{- with ne $year "20"}}
         {{$year}}
        {{end}}
    </a>
{{end}}

{{define "index-date"}}
    <div class="index-date">
      {{template "index-date-link" .}}
    </div>
{{end}}

